<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Incognito</title>

<style>
body{margin:0;font-family:sans-serif;background:#0f0f0f;color:#fff}
header{padding:14px;text-align:center;font-size:20px;font-weight:700}
.upload{padding:14px}
.upload input,.upload textarea,.upload button{
  width:100%;margin:6px 0;padding:12px;border-radius:10px;border:0
}
.upload input,.upload textarea{background:#1c1c1c;color:#fff}
.upload button{
  background:linear-gradient(135deg,#ff0050,#ff7a00);
  color:#fff;font-size:16px;font-weight:700
}
.post{margin:12px;background:#161616;border-radius:14px;overflow:hidden}
.post img{width:100%}
.caption{padding:10px;font-size:14px}
</style>
</head>

<body>

<header>Incognito</header>

<div class="upload">
  <input type="file" id="img" accept="image/*">
  <textarea id="cap" placeholder="Write something..."></textarea>
  <button onclick="post()">Post</button>
</div>

<div id="feed"></div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<script>
// ðŸ”´ FIREBASE CONFIG (APNA DALO)
const firebaseConfig = {
  apiKey: "YOUR_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// ðŸ”´ CLOUDINARY (APNA DALO)
const CLOUD = "YOUR_CLOUD_NAME";
const PRESET = "YOUR_UPLOAD_PRESET";

// ðŸ“¤ POST
async function post(){
  alert("Posting..."); // ðŸ”¥ TEST ALERT (yeh aana chahiye)

  const file = document.getElementById("img").files[0];
  const cap  = document.getElementById("cap").value;
  if(!file || !cap){ alert("Photo & caption required"); return; }

  let fd = new FormData();
  fd.append("file", file);
  fd.append("upload_preset", PRESET);

  let r = await fetch(`https://api.cloudinary.com/v1_1/${CLOUD}/image/upload`, {
    method:"POST", body:fd
  });
  let j = await r.json();

  await db.collection("posts").add({
    img: j.secure_url,
    cap: cap,
    time: Date.now(),
    likes: 0
  });

  document.getElementById("cap").value="";
  load();
}

// ðŸ“° LOAD
async function load(){
  let feed=document.getElementById("feed");
  feed.innerHTML="";
  let q=await db.collection("posts").orderBy("time","desc").get();
  q.forEach(d=>{
    let p=d.data();
    feed.innerHTML+=`
      <div class="post">
        <img src="${p.img}">
        <div class="caption">${p.cap}</div>
      </div>`;
  });
}
load();
</script>

</body>
</html>
